// Generated by CoffeeScript 1.6.3
var argsOf;

argsOf = require('../util').argsOf;

module.exports = function(Preparator, decoratedFn) {
  return (function(context, configured) {
    context.signature = argsOf(decoratedFn);
    context.first = [];
    context.last = [];
    if (Preparator.beforeAll != null) {
      Preparator.beforeAll(context);
    }
    return function() {
      var arg, result, _i, _j, _len, _len1;
      context.inject = typeof Preparator === 'function' ? Preparator(context.signature) : Preparator instanceof Array ? Preparator : Preparator instanceof Object ? (configured = true, []) : [Preparator];
      if (!configured) {
        for (_i = 0, _len = arguments.length; _i < _len; _i++) {
          arg = arguments[_i];
          context.inject.push(arg);
        }
        return decoratedFn.apply(null, context.first.concat(context.inject));
      }
      if (Preparator.beforeEach != null) {
        Preparator.beforeEach(context);
      }
      for (_j = 0, _len1 = arguments.length; _j < _len1; _j++) {
        arg = arguments[_j];
        context.inject.push(arg);
      }
      result = decoratedFn.apply(null, context.first.concat(context.inject).concat(context.last));
      if (Preparator.afterEach != null) {
        Preparator.afterEach(context, result);
      }
      return result;
    };
  })(function() {}, false);
};
